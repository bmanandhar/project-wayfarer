{"ast":null,"code":"import _defineProperty from \"/Users/bijayamanandhar/Desktop/project-wayfarer/wayfarer-front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/bijayamanandhar/Desktop/project-wayfarer/wayfarer-front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/Users/bijayamanandhar/Desktop/project-wayfarer/wayfarer-front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/bijayamanandhar/Desktop/project-wayfarer/wayfarer-front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/bijayamanandhar/Desktop/project-wayfarer/wayfarer-front-end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/bijayamanandhar/Desktop/project-wayfarer/wayfarer-front-end/src/components/Profile.js\";\nimport React, { Component } from \"react\";\nimport { Modal, Button } from \"react-bootstrap\";\nimport Posts from './Posts';\nimport axios from \"axios\";\nvar baseURL = 'http://localhost:8001';\nvar bioTxt = \"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s.\";\n\nvar Profile =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Profile, _Component);\n\n  function Profile() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Profile);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Profile)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      editUsername: false,\n      editCity: false,\n      usernameVal: '',\n      cityVal: '',\n      userData: {},\n      cities: [],\n      showPostModal: false,\n      postInfo: {}\n    };\n\n    _this.componentDidMount = function () {\n      axios.get(\"\".concat(baseURL, \"/users/profile\"), {\n        headers: {\n          \"Authorization\": \"Bearer \".concat(localStorage.token)\n        }\n      }).then(function (res) {\n        var userData = res.data;\n        userData.posts.map(function (post) {\n          var city = _this.props.cities.filter(function (city) {\n            return city.name === post.city;\n          })[0];\n\n          return post.image = city.image;\n        });\n\n        _this.setState({\n          userData: userData,\n          usernameVal: res.data.username,\n          cityVal: res.data.city\n        });\n      }).catch(function (err) {\n        console.log(err.response);\n        var status = err.response.data.error;\n\n        if (status === 401 || status === 403) {\n          alert(\"\".concat(err.response.data.message, \", logging out...\"));\n\n          _this.props.forcedLogOut();\n        }\n      });\n    };\n\n    _this.handleInput = function (e, option) {} //this.setState({ [option]: e.target.value })\n    // change to input tag when click on username\n    ;\n\n    _this.changeInputClick = function (option) {\n      _this.setState(_defineProperty({}, option, true));\n    };\n\n    _this.stopEdit = function (e, option, value) {\n      var _this$setState3;\n\n      //if (this.state[value]===\"\") return;\n      if (e.target.value === \"\") return;\n\n      if (_this.state[value] === e.target.value) {\n        _this.setState(_defineProperty({}, option, false));\n\n        return;\n      }\n\n      _this.axiosPatch(e);\n\n      _this.setState((_this$setState3 = {}, _defineProperty(_this$setState3, option, false), _defineProperty(_this$setState3, value, e.target.value), _this$setState3));\n    };\n\n    _this.updateCity = function (e, value) {\n      if (_this.state[value] === \"\") return;\n\n      _this.axiosPatch(e);\n\n      _this.handleInput(e, value);\n    };\n\n    _this.axiosPatch = function (e) {\n      axios.patch(\"\".concat(baseURL, \"/users/profile\"), _defineProperty({}, e.target.name, e.target.value), {\n        headers: {\n          \"Authorization\": \"Bearer \".concat(localStorage.token)\n        }\n      }).then(function (res) {\n        return console.log(res.data);\n      }).catch(function (err) {\n        console.log(err.response);\n        var status = err.response.data.error;\n\n        if (status === 401 || status === 403) {\n          _this.props.forcedLogOut();\n        }\n      });\n    };\n\n    _this.open = function (index) {\n      _this.setState({\n        showPostModal: true,\n        postInfo: _this.state.userData.posts[index]\n      });\n    };\n\n    _this.close = function () {\n      _this.setState({\n        showPostModal: false,\n        postInfo: {}\n      });\n    };\n\n    _this.render = function () {\n      var postList = [];\n\n      if (_this.state.userData.posts !== undefined) {\n        _this.state.userData.posts.map(function (post, i) {\n          return postList.push(React.createElement(Posts, {\n            data: post,\n            open: function open() {\n              return _this.open(i);\n            },\n            key: i,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 120\n            },\n            __self: this\n          }));\n        });\n      }\n\n      return React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"Profile\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"profile-div\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"profile-pic\",\n        src: \"images/\".concat(_this.state.userData.image),\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      })), !_this.state.editUsername ? React.createElement(\"h1\", {\n        className: \"profile-name\",\n        onClick: function onClick() {\n          return _this.changeInputClick(\"editUsername\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, _this.state.usernameVal) : React.createElement(\"h1\", {\n        className: \"profile-name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"edit-profile-name\",\n        type: \"text\",\n        name: \"username\",\n        defaultValue: _this.state.usernameVal,\n        onChange: function onChange(e) {\n          return _this.handleInput(e, \"usernameVal\");\n        },\n        onBlur: function onBlur(e) {\n          return _this.stopEdit(e, \"editUsername\", \"usernameVal\");\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      })), React.createElement(\"p\", {\n        className: \"bio\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, \"Joined:\", React.createElement(\"span\", {\n        style: {\n          margin: \"10px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, \" \", _this.state.userData.joindate, \" \")), React.createElement(\"p\", {\n        className: \"bio\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, \" Email:\", React.createElement(\"span\", {\n        style: {\n          margin: \"10px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, \" \", _this.state.userData.email, \" \")), React.createElement(\"p\", {\n        className: \"bio\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"City:\", React.createElement(\"span\", {\n        style: {\n          margin: \"10px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, React.createElement(\"select\", {\n        onChange: function onChange(e) {\n          return _this.updateCity(e, \"cityVal\");\n        },\n        name: \"city\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, _this.props.cities.map(function (city, index) {\n        return city.name !== _this.state.cityVal ? React.createElement(\"option\", {\n          key: index + 1,\n          value: city.name,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157\n          },\n          __self: this\n        }, city.name, \" \") : React.createElement(\"option\", {\n          key: index + 1,\n          value: city.name,\n          selected: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158\n          },\n          __self: this\n        }, city.name, \" \");\n      })))), React.createElement(\"p\", {\n        className: \"bio\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, false ? bioTxt : \"\")), React.createElement(\"div\", {\n        className: \"posts-list\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, \"Your Posts: \"), postList.length > 0 ? postList : React.createElement(\"h4\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, \"No post\")), React.createElement(Modal, {\n        bsSize: \"large\",\n        className: \"post-modal\",\n        show: _this.state.showPostModal,\n        onHide: _this.close,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, React.createElement(Modal.Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, React.createElement(Modal.Title, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, \"\".concat(_this.state.postInfo.title, \" \\n                by \").concat(_this.state.postInfo.author, \" \\n                on \").concat(_this.state.postInfo.date))), React.createElement(Modal.Body, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        className: \"post-modal-img\",\n        src: _this.state.postInfo.image,\n        alt: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, _this.state.postInfo.body)), React.createElement(Modal.Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(Button, {\n        className: \"green-btn\",\n        onClick: _this.close,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, \"Close\"))));\n    };\n\n    return _this;\n  }\n\n  return Profile;\n}(Component);\n\nexport { Profile as default };","map":{"version":3,"sources":["/Users/bijayamanandhar/Desktop/project-wayfarer/wayfarer-front-end/src/components/Profile.js"],"names":["React","Component","Modal","Button","Posts","axios","baseURL","bioTxt","Profile","state","editUsername","editCity","usernameVal","cityVal","userData","cities","showPostModal","postInfo","componentDidMount","get","headers","localStorage","token","then","res","data","posts","map","post","city","props","filter","name","image","setState","username","catch","err","console","log","response","status","error","alert","message","forcedLogOut","handleInput","e","option","changeInputClick","stopEdit","value","target","axiosPatch","updateCity","patch","open","index","close","render","postList","undefined","i","push","margin","joindate","email","length","title","author","date","body"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport { Modal, Button } from \"react-bootstrap\"\nimport Posts from './Posts';\nimport axios from \"axios\";\n\nconst baseURL= 'http://localhost:8001';\n\nconst bioTxt = \"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s.\"\n\nexport default class Profile extends Component {\n\n    state = {\n        editUsername: false,\n        editCity: false,\n        usernameVal: '',\n        cityVal: '',\n        userData: {},\n        cities: [],\n        showPostModal: false,\n        postInfo: {},\n    }\n\n    componentDidMount = () => {\n        axios.get(`${baseURL}/users/profile`,{headers: {\"Authorization\": `Bearer ${localStorage.token}`}})\n        .then(res=>{\n\n            let userData = res.data\n            userData.posts.map((post)=>{\n                let city = this.props.cities.filter(city=>city.name===post.city)[0]\n                return post.image = city.image\n            })\n\n            this.setState({\n                userData,\n                usernameVal: res.data.username,\n                cityVal: res.data.city\n            })\n        })\n        .catch((err)=>{\n            console.log(err.response)\n            let status = err.response.data.error\n            if (status===401 || status===403) {\n                alert(`${err.response.data.message}, logging out...`)\n                this.props.forcedLogOut()\n            }\n        })\n    }\n\n    \n    handleInput = (e,option) => {\n        //this.setState({ [option]: e.target.value })\n    }\n\n    // change to input tag when click on username\n    changeInputClick = (option) => {\n        this.setState({[option]: true})\n    }\n\n    // stop edit username\n    stopEdit = (e,option,value) => {\n        //if (this.state[value]===\"\") return;\n        if (e.target.value===\"\") return\n        if (this.state[value]===e.target.value) {\n            this.setState({ \n                [option]: false,\n            })\n            return;\n        }\n        this.axiosPatch(e)\n        this.setState({ \n            [option]: false,\n            [value]: e.target.value\n         })\n    }\n\n    // update city on change\n    updateCity = (e,value) => {\n        if (this.state[value]===\"\") return;\n        this.axiosPatch(e)\n        this.handleInput(e,value)\n    }\n\n    // axios call to update\n    axiosPatch = (e) => {\n        axios.patch(`${baseURL}/users/profile`,\n          {[e.target.name]: e.target.value},\n          {headers: {\"Authorization\": `Bearer ${localStorage.token}`}})\n        .then(res=>console.log(res.data))\n        .catch(err=>{\n            console.log(err.response)\n            let status = err.response.data.error\n            if (status===401 || status===403) {\n                this.props.forcedLogOut()\n            }\n        })\n    }\n\n    // open post modal\n    open = (index) => {\n        this.setState({\n            showPostModal: true,\n            postInfo: this.state.userData.posts[index]\n        })\n    }\n\n    // close post modal\n    close = () => {\n        this.setState({\n            showPostModal: false,\n            postInfo: {}\n        })\n    }\n\n\n    render = () => {\n\n        let postList = []\n        if (this.state.userData.posts!==undefined) {\n            this.state.userData.posts.map((post,i)=>(\n                postList.push(<Posts data={post} open={()=>this.open(i)} key={i} />)\n            ))\n        }\n        \n        return(\n\n  <React.Fragment>\n    <div className=\"Profile\">\n        <div className='profile-div'>\n            <img className=\"profile-pic\" src={`images/${this.state.userData.image}`} alt=\"\" />\n        </div>\n        {\n        !this.state.editUsername?\n            <h1 className='profile-name' onClick={()=>this.changeInputClick(\"editUsername\")}> \n            {this.state.usernameVal} \n            </h1> :\n            <h1 className='profile-name'>\n                <input className=\"edit-profile-name\" type=\"text\" name=\"username\" \n                    defaultValue={this.state.usernameVal} \n                    onChange={(e)=>this.handleInput(e,\"usernameVal\")} \n                    onBlur={(e)=>this.stopEdit(e,\"editUsername\",\"usernameVal\")} \n                />\n            </h1>\n        }\n        <p className='bio'>Joined: \n          <span style={{margin: \"10px\"}}> {this.state.userData.joindate} </span>\n        </p>\n        <p className='bio'> Email: \n          <span style={{margin: \"10px\"}}> {this.state.userData.email} </span>\n        </p>\n        <p className='bio'>\n          City:\n          <span style={{margin: \"10px\"}}>\n            <select onChange={(e)=>this.updateCity(e,\"cityVal\")} name=\"city\">\n            {\n            this.props.cities.map((city,index)=>(\n            city.name!==this.state.cityVal ? \n                <option key={index+1} value={city.name}>{city.name} </option> :\n                <option key={index+1} value={city.name} selected>{city.name} </option>\n            ))\n            }\n            </select>\n          </span>\n        </p>\n        <p className='bio'>{false? bioTxt : \"\"}</p>\n    </div>\n\n    <div className=\"posts-list\">\n        <h2>Your Posts: </h2>\n        {postList.length>0 ? postList : <h4>No post</h4>}\n    </div>\n\n    <Modal bsSize=\"large\" className=\"post-modal\" show={this.state.showPostModal} onHide = {this.close} >\n        <Modal.Header>\n            <Modal.Title>\n            {`${this.state.postInfo.title} \n                by ${this.state.postInfo.author} \n                on ${this.state.postInfo.date}`}\n            </Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n            <img className=\"post-modal-img\" src={this.state.postInfo.image} alt=\"\"/>\n            <p>\n                {this.state.postInfo.body}\n            </p>\n        </Modal.Body>\n        <Modal.Footer>\n            <Button className=\"green-btn\" onClick={this.close}>Close</Button>\n        </Modal.Footer>\n    </Modal>\n\n  </React.Fragment>\n\n        )\n    }\n}\n\n"]},"metadata":{},"sourceType":"module"}